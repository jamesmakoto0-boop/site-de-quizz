// 50 English Grammar questions for Bilan (Assessment) mode
export const bilanQuestions = [
  {
    id: 1,
    question: "She ____ to school every day.",
    instruction: "Choose the correct form:",
    options: ["go", "goes", "going"],
    correctIndex: 1,
    category: "Present Simple",
    difficulty: "easy"
  },
  {
    id: 2,
    question: "Which sentence is correct?",
    instruction: "Choose the correct sentence:",
    options: ["He don't like coffee.", "He doesn't like coffee.", "He isn't like coffee."],
    correctIndex: 1,
    category: "Present Simple Negative",
    difficulty: "easy"
  },
  {
    id: 3,
    question: "I have lived here ____ 2015.",
    instruction: "Fill in the blank:",
    options: ["for", "since", "during"],
    correctIndex: 1,
    category: "Present Perfect",
    difficulty: "medium"
  },
  {
    id: 4,
    question: "She bought ____ umbrella.",
    instruction: "Choose the correct article:",
    options: ["a", "an", "the"],
    correctIndex: 1,
    category: "Articles",
    difficulty: "easy"
  },
  {
    id: 5,
    question: "Which verb is in the past tense?",
    instruction: "Identify the past tense:",
    options: ["run", "ran", "running"],
    correctIndex: 1,
    category: "Past Simple",
    difficulty: "easy"
  },
  {
    id: 6,
    question: "This is ____ book.",
    instruction: "Choose the correct pronoun:",
    options: ["me", "mine", "my"],
    correctIndex: 2,
    category: "Possessive Pronouns",
    difficulty: "easy"
  },
  {
    id: 7,
    question: "____ you like pizza?",
    instruction: "Choose the correct question form:",
    options: ["Do", "Are", "Does"],
    correctIndex: 0,
    category: "Question Forms",
    difficulty: "easy"
  },
  {
    id: 8,
    question: "The cat is hiding ____ the table.",
    instruction: "Fill in the correct preposition:",
    options: ["under", "between", "over"],
    correctIndex: 0,
    category: "Prepositions",
    difficulty: "easy"
  },
  {
    id: 9,
    question: "They ____ very tired today.",
    instruction: "Choose the correct form of 'to be':",
    options: ["is", "are", "be"],
    correctIndex: 1,
    category: "Verb To Be",
    difficulty: "easy"
  },
  {
    id: 10,
    question: "Which sentence is correct?",
    instruction: "Choose the correct sentence:",
    options: ["She can to swim.", "She cans swim.", "She can swim."],
    correctIndex: 2,
    category: "Modal Verbs",
    difficulty: "easy"
  },
  {
    id: 11,
    question: "Right now, they ____ TV.",
    instruction: "Put the verb (watch) in the correct tense:",
    options: ["watch", "are watching", "watched"],
    correctIndex: 1,
    category: "Present Continuous",
    difficulty: "easy"
  },
  {
    id: 12,
    question: "A car is ____ than a bike.",
    instruction: "Choose the correct comparative form:",
    options: ["fast", "faster", "fastest"],
    correctIndex: 1,
    category: "Comparatives",
    difficulty: "easy"
  },
  {
    id: 13,
    question: "He has ____ friends in this city.",
    instruction: "Fill in the blank:",
    options: ["much", "many", "a lot"],
    correctIndex: 1,
    category: "Quantifiers",
    difficulty: "medium"
  },
  {
    id: 14,
    question: "Which sentence is correct?",
    instruction: "Choose the correct sentence:",
    options: ["I didn't went.", "I didn't go.", "I don't went."],
    correctIndex: 1,
    category: "Past Simple Negative",
    difficulty: "easy"
  },
  {
    id: 15,
    question: "We arrived ____ the airport at 7 PM.",
    instruction: "Fill in the correct preposition:",
    options: ["in", "at", "on"],
    correctIndex: 1,
    category: "Prepositions",
    difficulty: "medium"
  },
  {
    id: 16,
    question: "This is the ____ movie I've ever seen.",
    instruction: "Choose the correct form:",
    options: ["good", "better", "best"],
    correctIndex: 2,
    category: "Superlatives",
    difficulty: "easy"
  },
  {
    id: 17,
    question: "Which word order is correct?",
    instruction: "Choose the correct word order:",
    options: ["I always breakfast eat.", "I eat always breakfast.", "I always eat breakfast."],
    correctIndex: 2,
    category: "Word Order",
    difficulty: "medium"
  },
  {
    id: 18,
    question: "She ____ her homework already.",
    instruction: "Choose the correct tense:",
    options: ["did", "has done", "is doing"],
    correctIndex: 1,
    category: "Present Perfect",
    difficulty: "medium"
  },
  {
    id: 19,
    question: "If it rains, we ____ stay home.",
    instruction: "Fill in the blank:",
    options: ["will", "would", "are"],
    correctIndex: 0,
    category: "First Conditional",
    difficulty: "medium"
  },
  {
    id: 20,
    question: "This car is ____.",
    instruction: "Choose the correct possessive pronoun:",
    options: ["their", "theirs", "they"],
    correctIndex: 1,
    category: "Possessive Pronouns",
    difficulty: "medium"
  },
  {
    id: 21,
    question: "If I ____ more money, I would buy a new phone.",
    instruction: "Choose the correct condition:",
    options: ["have", "had", "will have"],
    correctIndex: 1,
    category: "Second Conditional",
    difficulty: "hard"
  },
  {
    id: 22,
    question: "He drives ____ than I do.",
    instruction: "Fill in the blank:",
    options: ["carefully", "more carefully", "most carefully"],
    correctIndex: 1,
    category: "Comparative Adverbs",
    difficulty: "medium"
  },
  {
    id: 23,
    question: "The cake ____ by my mother.",
    instruction: "Choose the correct passive form:",
    options: ["is made", "made", "is making"],
    correctIndex: 0,
    category: "Passive Voice",
    difficulty: "hard"
  },
  {
    id: 24,
    question: "Which sentence is correct?",
    instruction: "Choose the correct sentence:",
    options: ["There is many cars outside.", "There are many cars outside.", "There is much cars outside."],
    correctIndex: 1,
    category: "There is/are",
    difficulty: "easy"
  },
  {
    id: 25,
    question: "I am interested ____ robotics.",
    instruction: "Fill in the correct preposition:",
    options: ["in", "on", "about"],
    correctIndex: 0,
    category: "Prepositions",
    difficulty: "medium"
  },
  {
    id: 26,
    question: "We ____ to finish this today.",
    instruction: "Choose the correct verb:",
    options: ["have", "has", "having"],
    correctIndex: 0,
    category: "Subject-Verb Agreement",
    difficulty: "easy"
  },
  {
    id: 27,
    question: "You ____ wear a helmet. It is required.",
    instruction: "Choose the correct modal:",
    options: ["should", "must", "could"],
    correctIndex: 1,
    category: "Modal Verbs",
    difficulty: "medium"
  },
  {
    id: 28,
    question: "He is taller ____ his brother.",
    instruction: "Fill in the blank:",
    options: ["as", "than", "then"],
    correctIndex: 1,
    category: "Comparatives",
    difficulty: "easy"
  },
  {
    id: 29,
    question: "She didn't ____ the message.",
    instruction: "Choose the correct form:",
    options: ["receive", "receives", "receiving"],
    correctIndex: 0,
    category: "Past Simple Negative",
    difficulty: "easy"
  },
  {
    id: 30,
    question: "Which sentence is correct?",
    instruction: "Choose the correct sentence:",
    options: ["I'm looking forward to meet you.", "I'm looking forward to meeting you.", "I'm looking forward for meet you."],
    correctIndex: 1,
    category: "Gerunds",
    difficulty: "hard"
  },
  {
    id: 31,
    question: "They ____ dinner when I arrived.",
    instruction: "Choose the correct tense:",
    options: ["were having", "had", "have"],
    correctIndex: 0,
    category: "Past Continuous",
    difficulty: "medium"
  },
  {
    id: 32,
    question: "I wish I ____ speak French.",
    instruction: "Fill in the blank:",
    options: ["can", "could", "will"],
    correctIndex: 1,
    category: "Wish Clauses",
    difficulty: "hard"
  },
  {
    id: 33,
    question: "The meeting ____ at 9 AM tomorrow.",
    instruction: "Choose the correct form:",
    options: ["starts", "is starting", "will start"],
    correctIndex: 0,
    category: "Future Forms",
    difficulty: "medium"
  },
  {
    id: 34,
    question: "She asked me ____ I was feeling.",
    instruction: "Fill in the blank:",
    options: ["how", "what", "why"],
    correctIndex: 0,
    category: "Reported Speech",
    difficulty: "medium"
  },
  {
    id: 35,
    question: "Neither John ____ Mary came to the party.",
    instruction: "Choose the correct word:",
    options: ["or", "nor", "and"],
    correctIndex: 1,
    category: "Correlative Conjunctions",
    difficulty: "hard"
  },
  {
    id: 36,
    question: "The book ____ I read was interesting.",
    instruction: "Fill in the blank:",
    options: ["who", "which", "whom"],
    correctIndex: 1,
    category: "Relative Pronouns",
    difficulty: "medium"
  },
  {
    id: 37,
    question: "He's been working here ____ five years.",
    instruction: "Choose the correct preposition:",
    options: ["since", "for", "during"],
    correctIndex: 1,
    category: "Present Perfect",
    difficulty: "medium"
  },
  {
    id: 38,
    question: "____ the rain, we went for a walk.",
    instruction: "Fill in the blank:",
    options: ["Despite", "Although", "However"],
    correctIndex: 0,
    category: "Conjunctions",
    difficulty: "hard"
  },
  {
    id: 39,
    question: "She ____ have left already.",
    instruction: "Choose the correct modal:",
    options: ["must", "can", "should"],
    correctIndex: 0,
    category: "Modal Verbs",
    difficulty: "hard"
  },
  {
    id: 40,
    question: "I'd rather you ____ smoke here.",
    instruction: "Fill in the blank:",
    options: ["don't", "didn't", "won't"],
    correctIndex: 1,
    category: "Would Rather",
    difficulty: "hard"
  },
  {
    id: 41,
    question: "By next year, I ____ graduated.",
    instruction: "Choose the correct tense:",
    options: ["will have", "will be", "would have"],
    correctIndex: 0,
    category: "Future Perfect",
    difficulty: "hard"
  },
  {
    id: 42,
    question: "The more you practice, ____ you become.",
    instruction: "Fill in the blank:",
    options: ["better", "the better", "best"],
    correctIndex: 1,
    category: "Comparatives",
    difficulty: "hard"
  },
  {
    id: 43,
    question: "He suggested ____ a break.",
    instruction: "Choose the correct form:",
    options: ["to take", "taking", "take"],
    correctIndex: 1,
    category: "Gerunds",
    difficulty: "medium"
  },
  {
    id: 44,
    question: "I need ____ information about the project.",
    instruction: "Fill in the blank:",
    options: ["a", "some", "an"],
    correctIndex: 1,
    category: "Quantifiers",
    difficulty: "easy"
  },
  {
    id: 45,
    question: "She speaks English very ____.",
    instruction: "Choose the correct word:",
    options: ["good", "well", "better"],
    correctIndex: 1,
    category: "Adverbs",
    difficulty: "easy"
  },
  {
    id: 46,
    question: "____ does this word mean?",
    instruction: "Fill in the blank:",
    options: ["How", "What", "Which"],
    correctIndex: 1,
    category: "Question Words",
    difficulty: "easy"
  },
  {
    id: 47,
    question: "I haven't seen him ____ last week.",
    instruction: "Choose the correct word:",
    options: ["for", "since", "from"],
    correctIndex: 1,
    category: "Present Perfect",
    difficulty: "medium"
  },
  {
    id: 48,
    question: "The house ____ in 1990.",
    instruction: "Fill in the blank:",
    options: ["built", "was built", "has built"],
    correctIndex: 1,
    category: "Passive Voice",
    difficulty: "medium"
  },
  {
    id: 49,
    question: "You should ____ harder for the exam.",
    instruction: "Choose the correct verb:",
    options: ["to study", "study", "studying"],
    correctIndex: 1,
    category: "Modal Verbs",
    difficulty: "easy"
  },
  {
    id: 50,
    question: "If I had known, I ____ told you.",
    instruction: "Fill in the blank:",
    options: ["would have", "will have", "had"],
    correctIndex: 0,
    category: "Third Conditional",
    difficulty: "hard"
  }
];

// Get all 50 questions for Bilan mode (shuffled)
export const getBilanQuestions = () => {
  return [...bilanQuestions]
    .sort(() => Math.random() - 0.5)
    .map(q => ({
      ...q,
      ...shuffleOptions(q)
    }));
};

// Shuffle options and return new correct index
const shuffleOptions = (question) => {
  const correctAnswer = question.options[question.correctIndex];
  const shuffledOptions = [...question.options].sort(() => Math.random() - 0.5);
  const newCorrectIndex = shuffledOptions.indexOf(correctAnswer);
  return {
    options: shuffledOptions,
    correctIndex: newCorrectIndex
  };
};

// Analyze results by category
export const analyzeResults = (questions, answers) => {
  const categoryStats = {};
  
  questions.forEach((q, index) => {
    const answer = answers[index];
    if (!categoryStats[q.category]) {
      categoryStats[q.category] = {
        total: 0,
        correct: 0,
        difficulty: q.difficulty,
        questions: []
      };
    }
    categoryStats[q.category].total++;
    if (answer?.isCorrect) {
      categoryStats[q.category].correct++;
    }
    categoryStats[q.category].questions.push({
      question: q.question,
      isCorrect: answer?.isCorrect || false,
      difficulty: q.difficulty
    });
  });

  // Calculate percentage for each category
  Object.keys(categoryStats).forEach(cat => {
    categoryStats[cat].percentage = Math.round(
      (categoryStats[cat].correct / categoryStats[cat].total) * 100
    );
    categoryStats[cat].status = categoryStats[cat].percentage >= 70 ? 'acquired' : 'to-improve';
  });

  return categoryStats;
};

// Generate study plan based on results
export const generateStudyPlan = (categoryStats) => {
  const toImprove = Object.entries(categoryStats)
    .filter(([_, stats]) => stats.status === 'to-improve')
    .sort((a, b) => a[1].percentage - b[1].percentage);
  
  const acquired = Object.entries(categoryStats)
    .filter(([_, stats]) => stats.status === 'acquired')
    .sort((a, b) => b[1].percentage - a[1].percentage);

  // Create weekly plan
  const weeklyPlan = [];
  const today = new Date();
  
  toImprove.forEach(([category, stats], index) => {
    const startDate = new Date(today);
    startDate.setDate(startDate.getDate() + (index * 2)); // 2 days per topic
    
    const endDate = new Date(startDate);
    endDate.setDate(endDate.getDate() + 2);
    
    weeklyPlan.push({
      category,
      percentage: stats.percentage,
      difficulty: stats.difficulty,
      startDate: startDate.toISOString().split('T')[0],
      endDate: endDate.toISOString().split('T')[0],
      duration: 2,
      priority: index < 3 ? 'high' : index < 6 ? 'medium' : 'low',
      tips: getStudyTips(category)
    });
  });

  return {
    toImprove,
    acquired,
    weeklyPlan,
    totalWeeks: Math.ceil(toImprove.length * 2 / 7)
  };
};

// Get study tips for each category
const getStudyTips = (category) => {
  const tips = {
    'Present Simple': 'Practice daily routines and habits. Remember: he/she/it + verb+s',
    'Present Simple Negative': "Use don't/doesn't + base verb. He doesn't, not he don't.",
    'Present Perfect': "Use 'since' for points in time, 'for' for durations.",
    'Past Simple': 'Learn irregular verbs list. Regular verbs add -ed.',
    'Past Simple Negative': "didn't + base verb. Never use past form after didn't.",
    'Past Continuous': 'was/were + verb-ing for actions in progress in the past.',
    'Present Continuous': 'am/is/are + verb-ing for actions happening now.',
    'Future Forms': 'Will for decisions, going to for plans, present simple for schedules.',
    'Future Perfect': 'will have + past participle for completed future actions.',
    'Articles': "'A' before consonant sounds, 'an' before vowel sounds.",
    'Prepositions': 'Learn preposition + noun combinations. Practice with examples.',
    'Modal Verbs': 'Modal + base verb. Must = obligation, should = advice, can = ability.',
    'Possessive Pronouns': 'My/your/his + noun. Mine/yours/his alone (no noun after).',
    'Question Forms': 'Do/Does + subject + base verb for yes/no questions.',
    'Verb To Be': 'I am, you/we/they are, he/she/it is.',
    'Comparatives': 'Short adj + -er + than. More + long adj + than.',
    'Superlatives': 'The + short adj + -est. The most + long adj.',
    'Quantifiers': "Many/few for countable. Much/little for uncountable.",
    'Word Order': 'Subject + Verb + Object. Adverbs of frequency before main verb.',
    'First Conditional': 'If + present simple, will + base verb. Real possibilities.',
    'Second Conditional': 'If + past simple, would + base verb. Unreal situations.',
    'Third Conditional': 'If + past perfect, would have + past participle. Past regrets.',
    'Passive Voice': 'be + past participle. Focus on the action, not the doer.',
    'Gerunds': 'Verb + -ing as noun. Some verbs are followed by gerunds.',
    'Subject-Verb Agreement': 'Singular subject = singular verb. Plural = plural verb.',
    'Relative Pronouns': 'Who for people, which for things, that for both.',
    'Reported Speech': 'Shift tenses back. Direct â†’ Indirect speech.',
    'Conjunctions': 'Although/despite for contrast. Because/since for reason.',
    'Adverbs': 'Most adverbs end in -ly. Well is adverb of good.',
    'Question Words': 'What for things, who for people, where for places.',
    'Wish Clauses': 'Wish + past simple for present wishes.',
    'Would Rather': "Would rather + base verb. Would rather you + past simple.",
    'Comparative Adverbs': 'More + adverb + than for comparison.',
    'There is/are': 'There is + singular. There are + plural.',
    'Correlative Conjunctions': 'Neither...nor, either...or, both...and.'
  };
  return tips[category] || 'Practice with examples and exercises.';
};
